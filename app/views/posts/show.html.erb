<%= link_to "トップへ戻る", root_path %><br>
<%= link_to "一覧へ戻る", posts_path %><br>
  <%= @post.day.strftime('%Y/%m/%d') %><br>
  <%= @post.title %><br>
  <%= @post.body %><br>
  <%= image_tag @post.picture_url if @post.picture? %>
  <% if @post.youtube.present? %>
    <p>あの頃の曲</p>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/<%= @post.youtube %>" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    </p>
  <% end%>
  
<div id='map'></div>
          <input id="address" type="textbox" value=<%= @post.address %>>
          <input type="button" value="Encode" onclick="codeAddress()">
          </div>

          <style>
          #map{ height: 400px; }
          </style>

          <script>
          let map
          let geocoder

          function initMap(){
            // geocoderを初期化
            geocoder = new google.maps.Geocoder()

            map = new google.maps.Map(document.getElementById('map'), {
            center: {lat: 40.7828, lng:-73.9653},
            zoom: 8
            });
            //positionに指定した座標にピンを表示させます
            marker = new google.maps.Marker({
              position:  {lat: 40.7828, lng:-73.9653},
              map: map
            });
          }

          function codeAddress(){
            // 入力を取得
            let inputAddress = document.getElementById('address').value;

            // geocodingしたあとmapを移動
            geocoder.geocode( { 'address': inputAddress}, function(results, status) {
              if (status == 'OK') {
            // map.setCenterで地図が移動
                map.setCenter(results[0].geometry.location);

          // google.maps.MarkerでGoogleMap上の指定位置にマーカが立つ
                var marker = new google.maps.Marker({
                    map: map,
                    position: results[0].geometry.location
                });
              } else {
                alert('Geocode was not successful for the following reason: ' + status);
              }
            });
          }
          </script>
          <script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAP_API_KEY'] %>&callback=initMap" async defer></script>


<%= link_to "編集する", edit_post_path(@post.id) %>
<%= button_to "削除する", post_path(@post.id), method: :delete%>